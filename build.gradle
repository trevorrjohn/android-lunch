buildscript {
  repositories {
    mavenLocal()
    mavenCentral()
  }

  dependencies {
    classpath group: 'com.android.tools.build', name: 'gradle', version: '0.10.+'
    classpath group: 'org.robolectric.gradle', name: 'gradle-android-test-plugin', version: '0.10.+'
  }
}

allprojects {
  repositories {
    mavenCentral()
  }
}

apply plugin: 'android'
apply plugin: 'android-test'

android {
  packagingOptions {
    exclude 'LICENSE.txt'
    exclude 'META-INF/LICENSE'
    exclude 'META-INF/LICENSE.txt'
    exclude 'META-INF/NOTICE'
  }

  compileSdkVersion 18
  buildToolsVersion "19.1.0"

  defaultConfig {
    minSdkVersion 16
    targetSdkVersion 18
    versionCode 1
    versionName "1.0.0-SNAPSHOT"
    buildConfigField "String", "API_KEY", "\"${System.getProperty('apiKey')}\""
  }

  buildTypes {
    release {
      runProguard false
    }
  }

  sourceSets {
    androidTest {
      setRoot('src/test')
    }
  }
}

androidTest {
  include '**/*Test.class'
  maxHeapSize = "2048m"
}

dependencies {
  repositories {
    mavenCentral()
    mavenLocal()
    maven {
      url 'https://oss.sonatype.org/content/repositories/snapshots/'
    }
  }

  compile group: 'com.squareup.retrofit', name: 'retrofit', version: '1.6.1'
  compile group: 'org.roboguice', name: 'roboguice', version: '3.0-alpha-2'

  androidTestCompile group: 'junit', name: 'junit', version: '4.11'
  androidTestCompile group: 'org.robolectric', name: 'robolectric', version: '2.4-SNAPSHOT'
  androidTestCompile group: 'com.squareup', name: 'fest-android', version: '1.0.+'
  androidTestCompile group: 'org.mockito', name: 'mockito-core', version: '1.9.5'
}

apply plugin: 'idea'

idea {
  module {
    testOutputDir = file 'build/test-classes/debug'
  }
}

if (System.getProperty("intellij")) {
  exec {
    commandLine "scripts/fix_intellij_dependencies.sh"
  }
}
